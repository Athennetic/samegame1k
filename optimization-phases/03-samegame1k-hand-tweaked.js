{let e=[],f=window.a,h=f.getContext("2d"),l,m,n=(b,d)=>0>b||0>d||19<b||9<d?0:e[20*d+b],p=(b=()=>!(m=l=0)&&~~(4*Math.random()+1),d)=>{for(d=200;d--;)e[d]=b(e[d])},r=(b,d,c,g,k=g)=>{h.fillStyle="#"+"336c65aba58cfb7113732555245753449f87eee9cffea224".substr(3*b,3);h.fillRect(d,c,g,k)},t=(b,d)=>{r(15,0,0,528,288);h.font="12px sans-serif";h.fillStyle="#fff";h.fillText(`[New]    Score: ${l}    `+(1<m?`Marked: ${m} (+${m*m-4*m+4})`:0>m?"Game Over":""),8,280);for(b=20;b--;)for(d=10;d--;){let c=Math.abs(n(b,d)),g=0>n(b,d),k=26*b+4,q=26*d+4;r(c+5,k,q,26);r(c+10,k,q,25);r(c+10*g,k+1,q+1,24);g&&r(c+5,8+k,8+q,10)}},u=(b,d,c)=>0>=n(b,d)||c!=n(b,d)?0:(e[20*d+b]=-c)&&1+u(b-1,d,c)+u(b,d-1,c)+u(b+1,d,c)+u(b,d+1,c),v=(b,d,c,g)=>{b=20*d+b;c=20*g+c;g=e[b];e[b]=e[c];e[c]=g};p();t();f.onmousedown=b=>{let d=f.getBoundingClientRect(),c=b.clientX-d.left;b=b.clientY-d.top;42>c&&268<b&&288>b&&p();c=4>c?-1:~~((c-4)/26);b=4>b?-1:~~((b-4)/26);if(0>n(c,b)&&1<m){p(b=>0>b?0:b);for(c=20;c--;)for(d=!0;d;)for(d=!1,b=1;10>b;b++)!n(c,b)&&n(c,b-1)&&v(c,b,c,b-1,d=!0);for(d=!0;d;)for(d=!1,c=1;20>c;c++)if(!n(c-1,9)&&n(c,9))for(d=!0,b=10;b--;)v(c,b,c-1,b);l+=m*m-4*m+4;m=-1;for(c=20;c--;)for(b=10;b--;)m=1<u(c,b,n(c,b))?0:m}p(Math.abs);m=0>m?m:u(c,b,n(c,b));t()};}